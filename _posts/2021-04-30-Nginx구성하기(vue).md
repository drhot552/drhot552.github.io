---
title:  "[Web]Ubuntu Nginx구성하기(vue)"

categories:
  - WEB
last_modified_at: 2021-04-30T18:06:00-05:00
tags:
  - WEB
toc: true
toc_label: "[Web]Nginx구성하기(vue)"
---

# Nginx
Nginx이란?
웹 서버 소프트웨어로, 가벼움과 높은 성능을 목표로 한다. 웹 서버, 리버스 프록시 및 메일 프록시 기능을 가진다.

## Ubuntu EC2 Nginx 설치하기
- sudo apt-get update
- sudo apt-get install nginx

Nginx를 설치하면 아래 폴더 및 파일들이 생긴다.
/etc/nginx

├── conf.d
├── fastcgi.conf
├── fastcgi_params
├── koi-utf
├── koi-win
├── mime.types
├── nginx.conf
├── proxy_params
├── scgi_params
├── sites-available
│   └── default
├── sites-enabled
│   └── default -> /etc/nginx/sites-available/default
├── snippets
│   ├── fastcgi-php.conf
│   └── snakeoil.conf
├── uwsgi_params
└── win-utf

/etc/nginx/sites-available/default 파일을 열면 아래 server 부터 작성된 부분을 수정하면된다.

```javascript
server {
  //포트번호
	listen 8080 default_server;
	listen [::]:8080 default_server;

  //웹서비스를 실행시킬 build 경로
	root /home/ubuntu/real/luxury_dev/;

  //ip 및 호스트 주소
	server_name hereluxury.com;
	
  //경로 설정
	location / {
            root   /home/ubuntu/real/luxury_dev/;
            try_files $uri $uri/ @rewrites;
        }
        location @rewrites {
                rewrite ^(.+)$ /index.html last;
        }
}
```

## 코드 블럭 작성
- server {} : 도메인 단위의 1차 라우팅 (https://hereluxury.com이 이에 해당한다.)
- location {} : 도메인 내부의 2차 라우팅 (https://hereluxury.com/이 location 라우팅에 해당한다.)

### server 블럭 내 구문들
- server_name : server 블록에서 어떤 도메인을 라우팅 할 것인가가 이에 해당한다.
- access_log / error_log : 서버에 대한 로그를 남긴다.
- root : server_name에 해당하는 도메인이 있을 때, root 폴더를 지정할 수 있습니다. reverse forwading의 경우 생략된다.
  (vue의 경우 npm run build로 해서 나온 경로를 설정하면됩니다. ex)dist 폴더)
- index : 어떤 파일을 index 파일로 지정할 것인가를 설정합니다. reverse forwading의 경우 생략된다.
- location 블럭 내 구문들
try_files $uri $uri/ =404; : nginx는 정적 파일 호스팅을 기본적으로 지원하지 않기에, root 폴더 내에 uri 에 따른 폴더가 있는지 찾아보고, 만약 없다면 404 에러를 보여준다.
- @rewrites : 재작성(Rewrite)이란 요청을 통해서 주어진 URL의 규칙을 변경해서 웹서비스를 보다 유연하게 만드는 방법이다.  rewrite 모듈을 통해서 URL을 재작성 할 수 있다. 


## Nginx 삭제하기
nginx의 설정을 잘못하는 경우 아래 순서대로 명령어를 실행하면 삭제된다.
- sudo apt-get remove nginx nginx-common # config files을 제외하고 삭제
- sudo apt-get purge nginx nginx-common # 전체다 삭제
- sudo apt-get autoremove #종속성 관련 페키지 삭제
- rm -rf /etc/nginx


### 참조
[TIL - nginx 라우팅에 대하여 알아보자](https://velog.io/@pinot/nginx-%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90)



